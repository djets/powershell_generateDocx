# powershell_generateDocx
generating docx based on templates

## RUS
Скрипт powershell_generateDoc.ps1 предназначен для генерации документов по шаблонам на основании исходных данных.
Скрипт может запусткаться ярлыком powershell_generateDoc.lnk

**Возможности скрипта:**
- возможность настройки парсинга на основе регулярных выражений любых исходных данных;
- фильтрация полученых объектов по значению указанного поля (включая инверсию).

Файл настроек *.conf должен содержать обязательные параметры:
| **Параметр** | **Описание**  |
|----------------------------|------------------------------------------------------------|
| pattern_search |  Регулярное выражение с именованными группами для трансляции их карту полей записи. |
| pattern_filter |  Регулярное выражение используемое для фильтрации отбора полученных записей по значению заданного поля указанного в "sorting_field". |
| pattern_filter_enable |  Включение фильтрации (допустимые значения: true - включен и false - выключен). |
| pattern_filter_invers | Включение инверсии фильтрации (допустимые значения: true - включен и false - выключен). |
| sorting_field | Имя поля для фильтрации. Должно совпадать с именем именованной группы в регулярном выражении. |

По умолчанию регулярное выражение для отбора входных данных сотавлено для выгрузки из 1С-ЗуП в формате txt с разделителем - табуляция (файл примера - source_data.txt):

| **Реквизит 1С** | **Поле**  |
|----------------------------|------------------------------------------------------------|
| Сотрудник | fio |
| Комментарий | komment (опционально может содержался в поле исходных данных "Сотрудник")|
| Дата рождения | birthdate  |
| Адрес места проживания | registration (может быть пустым)|
| Серия(паспорт) | id_serial (может быть пустым)|
| Номер(паспорт) | id_number (может быть пустым)|
| Дата(паспорт) выдачи | date_of_issue (может быть пустым)|
| Кем выдано(паспорт) | owner_id (может быть пустым)|
| Код подразделения(паспорт) | owner_id_number (может быть пустым)|
| Должность по штатному расписанию | position |
| Подразделение | division (содержится в поле исходных данных "Должность по штатному расписанию")|
| Пол | gender (может быть пустым)|

В регулярном выражении предложенном по умолчанию формируются именнованные группы с соответсвующими названиями полей. Данные полученые из каждой строки будут добавлены в хештаблицу вида hashtable @{UID, @{field, value}}
Представленный набор избыточен для цели добавления пользователя в домен, но вы всегда можете использовать свой источник данных и настроенное под него регулярное выражение.
